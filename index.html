<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Curiara - Aplicaci√≥n de Ense√±anza del Lenguaje</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(to bottom, #1E88E5, #0D47A1); /* Cielo y agua del Amazonas */
      font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
    }
    #game-container {
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    #header {
      background: linear-gradient(to right, #4CAF50, #388E3C);
      padding: 15px 20px;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 10;
    }
    #logo {
      font-size: 28px;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    #score {
      display: flex;
      gap: 25px;
    }
    #score span {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
      font-size: 18px;
    }
    #score img {
      width: 35px;
      height: 35px;
      filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.3));
    }
    #map {
      flex: 1;
      position: relative;
      background-image: url('https://images.unsplash.com/photo-1554048616-bac87d9971ce?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
      background-size: cover;
      background-position: center;
      overflow: hidden;
    }
    .river-path {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      height: 8px;
      background: transparent;
    }
    .river-curve {
      position: absolute;
      height: 8px;
      background: linear-gradient(90deg, transparent, #2196F3, transparent);
      border-radius: 4px;
      box-shadow: 
        0 0 15px rgba(33, 150, 243, 0.6),
        inset 0 0 20px rgba(33, 150, 243, 0.8);
      animation: pulse 2s infinite alternate;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 15px rgba(33, 150, 243, 0.6), inset 0 0 20px rgba(33, 150, 243, 0.8); }
      100% { box-shadow: 0 0 25px rgba(33, 150, 243, 0.8), inset 0 0 30px rgba(33, 150, 243, 1); }
    }
    .path-marker {
      position: absolute;
      width: 55px;
      height: 55px;
      background: #FFD700;
      border: 3px solid #FFC107;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 22px;
      font-weight: bold;
      color: #D84315;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 6px 12px rgba(0,0,0,0.3),
        inset 0 -3px 6px rgba(0,0,0,0.2);
      z-index: 10;
    }
    .path-marker:hover {
      transform: scale(1.15) translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.4);
    }
    .path-marker.completed {
      background: #4CAF50;
      border-color: #388E3C;
      color: white;
    }
    .path-marker.locked {
      background: #9E9E9E;
      border-color: #757575;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .canoe {
      position: absolute;
      width: 40px;
      height: 30px;
      background: #8D6E63;
      border-radius: 50% 50% 0 0;
      transform: rotate(45deg);
      z-index: 5;
    }
    .canoe::after {
      content: '';
      position: absolute;
      width: 10px;
      height: 20px;
      background: #5D4037;
      border-radius: 3px;
      top: -10px;
      left: 15px;
    }
    #footer {
      background: linear-gradient(to right, #8D6E63, #6D4C41);
      padding: 18px 20px;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -4px 8px rgba(0,0,0,0.2);
      z-index: 10;
    }
    #footer button {
      background: #FFD700;
      color: #5D4037;
      border: 3px solid #FFC107;
      padding: 14px 20px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 12px;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 80px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    #footer button:hover {
      background: #FFC107;
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    #footer img {
      width: 32px;
      height: 32px;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: linear-gradient(to bottom, #4CAF50, #388E3C);
      padding: 25px;
      border-radius: 15px;
      width: 85%;
      max-width: 450px;
      text-align: center;
      border: 4px solid #FFD700;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    }
    .close {
      color: #FFD700;
      float: right;
      font-size: 32px;
      font-weight: bold;
      cursor: pointer;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    .close:hover {
      color: #FFC107;
    }
    h2 {
      color: #FFD700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      margin-top: 0;
    }
    .activity-content {
      margin: 20px 0;
      font-size: 19px;
      color: white;
      line-height: 1.5;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }
    .btn-primary {
      background: #FFD700;
      color: #5D4037;
      border: none;
      padding: 14px 24px;
      font-size: 18px;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      background: #FFC107;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    .world-item, .reward-item, .progress-item {
      padding: 18px;
      margin: 12px 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }
    .world-item:hover, .reward-item:hover, .progress-item:hover {
      transform: translateX(8px);
      background: rgba(255, 255, 255, 0.3);
      box-shadow: 0 6px 12px rgba(0,0,0,0.2);
    }
    .reward-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .progress-bar {
      width: 100%;
      height: 22px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 11px;
      margin: 12px 0;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(to right, #FFD700, #FFC107);
      width: 0%;
      transition: width 1s ease;
    }
    .nav-buttons {
      display: flex;
      justify-content: space-around;
      margin-top: 25px;
    }
    .nav-button {
      background: #FFD700;
      color: #5D4037;
      border: none;
      padding: 14px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .nav-button:hover {
      background: #FFC107;
      transform: translateY(-2px);
    }
    .activity-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 20px;
    }
    .activity-btn {
      background: #2196F3;
      color: white;
      border: 3px solid #1976D2;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .activity-btn:hover {
      background: #1976D2;
      transform: translateY(-2px);
    }
    .level-info {
      font-size: 16px;
      color: rgba(255, 255, 255, 0.9);
      margin-top: 12px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }
    .example-audio {
      margin: 20px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    .audio-controls {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 12px;
    }
    .audio-btn {
      background: #9C27B0;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 15px;
      transition: all 0.3s ease;
    }
    .audio-btn:hover {
      background: #7B1FA2;
      transform: translateY(-2px);
    }
    .record-btn {
      background: #E53935;
      border-color: #C62828;
    }
    .record-btn:hover {
      background: #C62828;
    }
    .record-animation {
      display: none;
      text-align: center;
      color: #E53935;
      font-weight: bold;
      font-size: 18px;
      margin: 15px 0;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }
    .checklist {
      text-align: left;
      margin: 20px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }
    .checklist-item {
      margin: 8px 0;
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
      font-size: 16px;
    }
    .checklist-item i {
      color: #FFD700;
      font-size: 20px;
    }
    .checklist-item.completed i {
      color: #4CAF50;
    }
    .world-modal-content {
      background: linear-gradient(to bottom, #4CAF50, #388E3C);
      padding: 25px;
      border-radius: 15px;
      width: 85%;
      max-width: 450px;
      text-align: center;
      border: 4px solid #FFD700;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    }
    .world-title {
      font-size: 26px;
      color: #FFD700;
      margin-bottom: 18px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    .world-description {
      font-size: 17px;
      color: white;
      margin-bottom: 22px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      line-height: 1.5;
    }
    .world-background {
      background-size: cover;
      background-position: center;
      height: 220px;
      border-radius: 12px;
      margin-bottom: 18px;
      border: 4px solid #FFD700;
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    .world-1 {
      background-image: url('https://images.unsplash.com/photo-1554048616-bac87d9971ce?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
    }
    .world-2 {
      background-image: url('https://images.unsplash.com/photo-1502657877623-f66bf489d236?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
    }
    .world-3 {
      background-image: url('https://images.unsplash.com/photo-1565008574585-3ea1f23b928d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
    }
    .world-4 {
      background-image: url('https://images.unsplash.com/photo-1533090161767-e6ffed986c83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
    }
    .amazon-river {
      position: absolute;
      width: 100%;
      height: 40%;
      bottom: 0;
      background: linear-gradient(to top, #1565C0, #1976D2, #42A5F5);
      clip-path: ellipse(80% 60% at 50% 100%);
      z-index: 1;
    }
    .jungle-overlay {
      position: absolute;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(67, 160, 71, 0.3), transparent 30%),
        radial-gradient(circle at 80% 20%, rgba(139, 195, 74, 0.3), transparent 30%),
        radial-gradient(circle at 30% 80%, rgba(56, 142, 60, 0.3), transparent 30%);
      pointer-events: none;
    }
    .leaf {
      position: absolute;
      color: #4CAF50;
      font-size: 24px;
      opacity: 0.7;
      animation: float 6s infinite ease-in-out;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }
  </style>
</head>
<body>
  <div id="game-container">
    <!-- Barra Superior -->
    <div id="header">
      <div id="logo">Curiara</div>
      <div id="score">
        <span><img src="https://img.icons8.com/emoji/48/000000/star-emoji.png" alt="Puntos"> <span id="points">100</span></span>
        <span><img src="https://img.icons8.com/emoji/48/000000/coin.png" alt="Monedas"> <span id="coins">50</span></span>
      </div>
    </div>
    <!-- Mapa Interactivo -->
    <div id="map">
      <div class="river-path" id="river-path"></div>
      <div class="canoe" id="canoe"></div>
      <div class="amazon-river"></div>
      <div class="jungle-overlay" id="jungle-overlay"></div>
    </div>
    <!-- Barra Inferior -->
    <div id="footer">
      <button id="play-btn">
        <img src="https://img.icons8.com/ios-filled/50/2ECC71/play.png" alt="Jugar">
        Jugar
      </button>
      <button id="worlds-btn">
        <img src="https://img.icons8.com/ios-filled/50/2ECC71/globe.png" alt="Mundos">
        Mundos
      </button>
      <button id="rewards-btn">
        <img src="https://img.icons8.com/ios-filled/50/2ECC71/trophy.png" alt="Recompensas">
        Recompensas
      </button>
      <button id="progress-btn">
        <img src="https://img.icons8.com/ios-filled/50/2ECC71/checklist.png" alt="Progreso">
        Mi Progreso
      </button>
    </div>
  </div>
  <!-- Modal para actividades -->
  <div id="activity-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="activity-title">Actividad</h2>
      <div id="activity-content" class="activity-content">
        Aqu√≠ se mostrar√° la actividad de ense√±anza del lenguaje.
      </div>
      <div class="level-info" id="level-info">Nivel 1 de 10</div>
      <div class="example-audio">
        <h3>üîä Escucha el ejemplo</h3>
        <div class="audio-controls">
          <button class="audio-btn" id="play-example">
            <span>‚ñ∂</span> Reproducir Ejemplo
          </button>
        </div>
      </div>
      <div class="checklist">
        <div class="checklist-item" id="step1">
          <i>‚óã</i> <span>Escuchar el ejemplo</span>
        </div>
        <div class="checklist-item" id="step2">
          <i>‚óã</i> <span>Practicar la pronunciaci√≥n</span>
        </div>
        <div class="checklist-item" id="step3">
          <i>‚óã</i> <span>Grabar tu voz</span>
        </div>
      </div>
      <div class="record-animation" id="record-animation">
        üé§ Grabando... Espere 3 segundos
      </div>
      <div class="activity-options">
        <button class="activity-btn record-btn" id="record-btn">
          <span>‚óè</span> Grabar Mi Voz
        </button>
      </div>
      <button class="btn-primary" id="complete-activity">Completar Actividad</button>
    </div>
  </div>
  <!-- Modal para Mundos -->
  <div id="worlds-modal" class="modal">
    <div class="world-modal-content">
      <span class="close">&times;</span>
      <h2 class="world-title">üåç Mundos de la Amazon√≠a</h2>
      <div id="worlds-list">
        <div class="world-item" data-world="1">
          <h3>üåø Selva Profunda</h3>
          <p>Aprende palabras de animales y plantas</p>
        </div>
        <div class="world-item" data-world="2">
          <h3>üíß R√≠os y Cauces</h3>
          <p>Actividades con sonidos del agua</p>
        </div>
        <div class="world-item" data-world="3">
          <h3>üå§Ô∏è Claros del Bosque</h3>
          <p>Juegos de luz y sombra con palabras</p>
        </div>
        <div class="world-item" data-world="4">
          <h3>üåßÔ∏è Lluvias Tropicales</h3>
          <p>Onomatopeyas y sonidos de la lluvia</p>
        </div>
      </div>
      <div class="nav-buttons">
        <button class="nav-button close-worlds">Cerrar</button>
      </div>
    </div>
  </div>
  <!-- Modal para Recompensas -->
  <div id="rewards-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>üèÜ Mis Recompensas</h2>
      <div id="rewards-list">
        <div class="reward-item">
          <span>üåü Estrella del Habla</span>
          <span>üîí</span>
        </div>
        <div class="reward-item">
          <span>üê∏ Rana Parlante</span>
          <button class="btn-primary" data-cost="10">Canjear (10)</button>
        </div>
        <div class="reward-item">
          <span>ü¶ú Loro Repetidor</span>
          <button class="btn-primary" data-cost="25">Canjear (25)</button>
        </div>
        <div class="reward-item">
          <span>üêµ Mono Conversador</span>
          <button class="btn-primary" data-cost="50">Canjear (50)</button>
        </div>
      </div>
      <div class="nav-buttons">
        <button class="nav-button close-rewards">Cerrar</button>
      </div>
    </div>
  </div>
  <!-- Modal para Progreso -->
  <div id="progress-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>üìà Mi Progreso</h2>
      <div id="progress-content">
        <p>Nivel actual: <strong id="current-level">1</strong></p>
        <p>Experiencia:</p>
        <div class="progress-bar">
          <div class="progress-fill" id="exp-bar"></div>
        </div>
        <p id="exp-text">0/1000 puntos</p>
        <p>Habilidades desarrolladas:</p>
        <div class="progress-item">
          <p>üó£Ô∏è Pronunciaci√≥n: <span id="pronunciation">0%</span></p>
        </div>
        <div class="progress-item">
          <p>üìñ Vocabulario: <span id="vocabulary">0%</span></p>
        </div>
        <div class="progress-item">
          <p>üí¨ Formaci√≥n de oraciones: <span id="sentences">0%</span></p>
        </div>
      </div>
      <div class="nav-buttons">
        <button class="nav-button close-progress">Cerrar</button>
      </div>
    </div>
  </div>
  <!-- Modales para mundos espec√≠ficos -->
  <div id="world-1-modal" class="modal">
    <div class="world-modal-content">
      <span class="close">&times;</span>
      <div class="world-background world-1"></div>
      <h2 class="world-title">üåø Selva Profunda</h2>
      <p class="world-description">En este mundo aprender√°s palabras de animales y plantas t√≠picos de la selva.</p>
      <button class="btn-primary" id="start-world-1">Entrar al Mundo</button>
    </div>
  </div>
  <div id="world-2-modal" class="modal">
    <div class="world-modal-content">
      <span class="close">&times;</span>
      <div class="world-background world-2"></div>
      <h2 class="world-title">üíß R√≠os y Cauces</h2>
      <p class="world-description">Descubre los sonidos del agua y las palabras relacionadas con los r√≠os y cauces.</p>
      <button class="btn-primary" id="start-world-2">Entrar al Mundo</button>
    </div>
  </div>
  <div id="world-3-modal" class="modal">
    <div class="world-modal-content">
      <span class="close">&times;</span>
      <div class="world-background world-3"></div>
      <h2 class="world-title">üå§Ô∏è Claros del Bosque</h2>
      <p class="world-description">Juega con luces y sombras mientras aprendes nuevas palabras.</p>
      <button class="btn-primary" id="start-world-3">Entrar al Mundo</button>
    </div>
  </div>
  <div id="world-4-modal" class="modal">
    <div class="world-modal-content">
      <span class="close">&times;</span>
      <div class="world-background world-4"></div>
      <h2 class="world-title">üåßÔ∏è Lluvias Tropicales</h2>
      <p class="world-description">Aprende onomatopeyas y sonidos de la lluvia en esta aventura.</p>
      <button class="btn-primary" id="start-world-4">Entrar al Mundo</button>
    </div>
  </div>
  <script>
    // Crear hojas decorativas
    function createLeaves() {
      const jungle = document.getElementById('jungle-overlay');
      const leafChars = ['üçÉ', 'üåø', 'üå¥', 'üå±'];
      for (let i = 0; i < 15; i++) {
        const leaf = document.createElement('div');
        leaf.className = 'leaf';
        leaf.textContent = leafChars[Math.floor(Math.random() * leafChars.length)];
        leaf.style.left = `${Math.random() * 100}%`;
        leaf.style.top = `${Math.random() * 100}%`;
        leaf.style.animationDelay = `${Math.random() * 5}s`;
        jungle.appendChild(leaf);
      }
    }
    // Datos del juego
    const gameData = {
      points: 100,
      coins: 50,
      currentLevel: 1,
      maxUnlockedLevel: 1,
      exp: 0,
      expToNext: 1000,
      pronunciation: 0,
      vocabulary: 0,
      sentences: 0,
      // Actividades para cada nivel
      activities: [
        {
          title: "Repite despu√©s de m√≠",
          content: "Escucha y repite: 'La rana verde salta sobre la hoja grande'",
          example: "La rana verde salta sobre la hoja grande",
          difficulty: "F√°cil",
          category: "Pronunciaci√≥n"
        },
        {
          title: "Encuentra palabras con S",
          content: "Encuentra 3 palabras que empiezan con la letra 'S': sol, serpiente, sapo",
          example: "Sol, Serpiente, Sapo",
          difficulty: "F√°cil",
          category: "Vocabulario"
        },
        {
          title: "Forma una oraci√≥n",
          content: "Usa las palabras: 'mono', 'come', 'pl√°tano' para formar una oraci√≥n",
          example: "El mono come un pl√°tano",
          difficulty: "Medio",
          category: "Oraciones"
        },
        {
          title: "Imita sonidos",
          content: "Imita el sonido del jaguar: 'Grrrrr'",
          example: "Grrrrr",
          difficulty: "F√°cil",
          category: "Pronunciaci√≥n"
        },
        {
          title: "Cuenta animales",
          content: "Cuenta 5 animales de la selva: mono, jaguar, serpiente, p√°jaro, sapo",
          example: "Mono, Jaguar, Serpiente, P√°jaro, Sapo",
          difficulty: "Medio",
          category: "Vocabulario"
        },
        {
          title: "Describe un √°rbol",
          content: "Describe c√≥mo es un √°rbol de la selva con 3 palabras: alto, verde, fuerte",
          example: "Alto, Verde, Fuerte",
          difficulty: "Medio",
          category: "Oraciones"
        },
        {
          title: "Canci√≥n de la lluvia",
          content: "Canta: 'Plin, plan, plin, plan, la lluvia cae en el r√≠o'",
          example: "Plin, plan, plin, plan, la lluvia cae en el r√≠o",
          difficulty: "F√°cil",
          category: "Pronunciaci√≥n"
        },
        {
          title: "Camina como un cangrejo",
          content: "Muestra con tus manos c√≥mo camina un cangrejo y di: 'El cangrejo camina de lado'",
          example: "El cangrejo camina de lado",
          difficulty: "Medio",
          category: "Oraciones"
        },
        {
          title: "Nido de p√°jaro",
          content: "Dime qu√© hace un p√°jaro en su nido: 'El p√°jaro cuida a sus polluelos'",
          example: "El p√°jaro cuida a sus polluelos",
          difficulty: "Dif√≠cil",
          category: "Oraciones"
        },
        {
          title: "Historia de la selva",
          content: "Cuenta una historia corta de 3 oraciones sobre la selva",
          example: "En la selva vive un mono. El mono come pl√°tanos. El mono es feliz.",
          difficulty: "Dif√≠cil",
          category: "Oraciones"
        }
      ],
      // Recompensas por nivel
      levelRewards: [
        { points: 10, coins: 5, exp: 100 },
        { points: 15, coins: 8, exp: 120 },
        { points: 20, coins: 10, exp: 150 },
        { points: 25, coins: 12, exp: 180 },
        { points: 30, coins: 15, exp: 220 },
        { points: 35, coins: 18, exp: 260 },
        { points: 40, coins: 20, exp: 300 },
        { points: 45, coins: 25, exp: 350 },
        { points: 50, coins: 30, exp: 400 },
        { points: 60, coins: 40, exp: 500 }
      ],
      // Progreso de habilidades por nivel
      skillProgress: [
        { pronunciation: 10, vocabulary: 8, sentences: 5 },
        { pronunciation: 12, vocabulary: 10, sentences: 8 },
        { pronunciation: 15, vocabulary: 12, sentences: 10 },
        { pronunciation: 18, vocabulary: 15, sentences: 12 },
        { pronunciation: 20, vocabulary: 18, sentences: 15 },
        { pronunciation: 22, vocabulary: 20, sentences: 18 },
        { pronunciation: 25, vocabulary: 22, sentences: 20 },
        { pronunciation: 28, vocabulary: 25, sentences: 22 },
        { pronunciation: 30, vocabulary: 28, sentences: 25 },
        { pronunciation: 35, vocabulary: 32, sentences: 30 }
      ],
      // Estado de pasos completados
      stepsCompleted: [false, false, false],
      // Mundo actual
      currentWorld: 1
    };
    // Actualizar puntos y monedas
    function updateScore() {
      document.getElementById('points').textContent = gameData.points;
      document.getElementById('coins').textContent = gameData.coins;
    }
    // Crear el r√≠o serpenteante y los marcadores de nivel
    function createRiverPath() {
      const riverPath = document.getElementById('river-path');
      const map = document.getElementById('map');
      // Definir los puntos del r√≠o serpenteante
      const riverPoints = [
        { x: 5, y: 50 },   // Inicio
        { x: 20, y: 30 },  // Curva 1
        { x: 35, y: 70 },  // Curva 2
        { x: 50, y: 40 },  // Curva 3
        { x: 65, y: 80 },  // Curva 4
        { x: 80, y: 50 },  // Curva 5
        { x: 95, y: 60 }   // Fin
      ];
      // Crear segmentos del r√≠o
      for (let i = 0; i < riverPoints.length - 1; i++) {
        const start = riverPoints[i];
        const end = riverPoints[i + 1];
        const dx = end.x - start.x;
        const dy = end.y - start.y;
        const length = Math.sqrt(dx * dx + dy * dy);
        const angle = Math.atan2(dy, dx) * 180 / Math.PI;
        const segment = document.createElement('div');
        segment.className = 'river-curve';
        segment.style.width = `${length}%`;
        segment.style.left = `${start.x}%`;
        segment.style.top = `${start.y}%`;
        segment.style.transform = `rotate(${angle}deg)`;
        segment.style.transformOrigin = '0 4px';
        riverPath.appendChild(segment);
      }
      // Crear marcadores de nivel a lo largo del r√≠o
      const numLevels = 10;
      for (let i = 1; i <= numLevels; i++) {
        const ratio = (i - 1) / (numLevels - 1);
        // Interpolaci√≥n a lo largo de los puntos del r√≠o
        let x, y;
        if (ratio <= 0.166) {
          // Entre punto 0 y 1
          const t = ratio / 0.166;
          x = 5 + t * (20 - 5);
          y = 50 + t * (30 - 50);
        } else if (ratio <= 0.333) {
          // Entre punto 1 y 2
          const t = (ratio - 0.166) / 0.167;
          x = 20 + t * (35 - 20);
          y = 30 + t * (70 - 30);
        } else if (ratio <= 0.5) {
          // Entre punto 2 y 3
          const t = (ratio - 0.333) / 0.167;
          x = 35 + t * (50 - 35);
          y = 70 + t * (40 - 70);
        } else if (ratio <= 0.666) {
          // Entre punto 3 y 4
          const t = (ratio - 0.5) / 0.166;
          x = 50 + t * (65 - 50);
          y = 40 + t * (80 - 40);
        } else if (ratio <= 0.833) {
          // Entre punto 4 y 5
          const t = (ratio - 0.666) / 0.167;
          x = 65 + t * (80 - 65);
          y = 80 + t * (50 - 80);
        } else {
          // Entre punto 5 y 6
          const t = (ratio - 0.833) / 0.167;
          x = 80 + t * (95 - 80);
          y = 50 + t * (60 - 50);
        }
        const marker = document.createElement('div');
        marker.className = 'path-marker';
        marker.textContent = i;
        marker.dataset.level = i;
        marker.style.left = `calc(${x}% - 27px)`;
        marker.style.top = `calc(${y}% - 27px)`;
        // Actualizar estado del nivel
        updateLevelMarker(marker, i);
        // Evento de clic
        marker.addEventListener('click', () => openActivity(i));
        riverPath.appendChild(marker);
      }
      // Posicionar la canoa
      const canoe = document.getElementById('canoe');
      const firstMarker = document.querySelector('.path-marker[data-level="1"]');
      if (firstMarker) {
        canoe.style.left = firstMarker.style.left;
        canoe.style.top = `calc(${firstMarker.style.top} + 30px)`;
      }
    }
    // Actualizar estado de un marcador de nivel
    function updateLevelMarker(marker, level) {
      if (level > gameData.maxUnlockedLevel) {
        marker.classList.remove('completed');
        marker.classList.add('locked');
        marker.style.cursor = 'not-allowed';
      } else if (level < gameData.maxUnlockedLevel) {
        marker.classList.remove('locked');
        marker.classList.add('completed');
        marker.style.cursor = 'pointer';
      } else {
        marker.classList.remove('completed', 'locked');
        marker.style.cursor = 'pointer';
      }
    }
    // Abrir modal con actividad
    function openActivity(level) {
      const modal = document.getElementById('activity-modal');
      const title = document.getElementById('activity-title');
      const content = document.getElementById('activity-content');
      const levelInfo = document.getElementById('level-info');
      if (level > gameData.maxUnlockedLevel) {
        alert('¬°Primero debes completar los niveles anteriores!');
        return;
      }
      const activity = gameData.activities[level - 1];
      title.textContent = `${activity.title}`;
      content.textContent = activity.content;
      levelInfo.textContent = `Nivel ${level} de 10 - ${activity.difficulty} - ${activity.category}`;
      // Resetear pasos completados
      gameData.stepsCompleted = [false, false, false];
      updateChecklist();
      modal.style.display = 'flex';
    }
    // Cerrar modales
    function closeActivity() {
      document.getElementById('activity-modal').style.display = 'none';
    }
    function closeWorlds() {
      document.getElementById('worlds-modal').style.display = 'none';
    }
    function closeRewards() {
      document.getElementById('rewards-modal').style.display = 'none';
    }
    function closeProgress() {
      document.getElementById('progress-modal').style.display = 'none';
    }
    // Actualizar barra de progreso
    function updateProgressBars() {
      const expPercent = (gameData.exp / gameData.expToNext) * 100;
      document.getElementById('exp-bar').style.width = `${expPercent}%`;
      document.getElementById('exp-text').textContent = `${gameData.exp}/${gameData.expToNext} puntos`;
      document.getElementById('current-level').textContent = gameData.currentLevel;
      document.getElementById('pronunciation').textContent = `${gameData.pronunciation}%`;
      document.getElementById('vocabulary').textContent = `${gameData.vocabulary}%`;
      document.getElementById('sentences').textContent = `${gameData.sentences}%`;
    }
    // Actualizar lista de verificaci√≥n
    function updateChecklist() {
      const steps = ['step1', 'step2', 'step3'];
      steps.forEach((step, index) => {
        const element = document.getElementById(step);
        if (element) {
          const icon = element.querySelector('i');
          if (gameData.stepsCompleted[index]) {
            icon.textContent = '‚úì';
            element.classList.add('completed');
          } else {
            icon.textContent = '‚óã';
            element.classList.remove('completed');
          }
        }
      });
    }
    // Simular reproducci√≥n de ejemplo
    function playExample() {
      const title = document.getElementById('activity-title').textContent;
      const levelMatch = title.match(/Nivel (\d+)/);
      const level = levelMatch ? parseInt(levelMatch[1]) : gameData.maxUnlockedLevel;
      const activity = gameData.activities[level - 1];
      alert(`üîä Escuchando ejemplo del nivel ${level}:
"${activity.example}"`);
      // Marcar paso 1 como completado
      gameData.stepsCompleted[0] = true;
      updateChecklist();
    }
    // Simular grabaci√≥n de voz
    function recordVoice() {
      // Verificar que el paso 1 (escuchar) est√© completado
      if (!gameData.stepsCompleted[0]) {
        alert('Primero debes escuchar el ejemplo antes de grabar tu voz.');
        return;
      }
      const recordAnimation = document.getElementById('record-animation');
      recordAnimation.style.display = 'block';
      // Simular grabaci√≥n de 3 segundos
      setTimeout(() => {
        recordAnimation.style.display = 'none';
        // Mostrar resultado de la grabaci√≥n
        const title = document.getElementById('activity-title').textContent;
        const levelMatch = title.match(/Nivel (\d+)/);
        const level = levelMatch ? parseInt(levelMatch[1]) : gameData.maxUnlockedLevel;
        const resultado = Math.random() > 0.3; // 70% de √©xito
        if (resultado) {
          alert(`üéâ ¬°Buena pronunciaci√≥n! Tu voz se grab√≥ correctamente.
Nivel ${level} completado con √©xito.`);
          gameData.stepsCompleted[1] = true;
          gameData.stepsCompleted[2] = true;
        } else {
          alert(`üéØ Casi lo logras. Escucha nuevamente el ejemplo y practica un poco m√°s.
Tu esfuerzo es importante.`);
          gameData.stepsCompleted[1] = true;
          gameData.stepsCompleted[2] = true;
        }
        updateChecklist();
      }, 3000);
    }
    // Completar actividad
    function completeActivity() {
      // Verificar que todos los pasos est√©n completados
      if (!gameData.stepsCompleted[0]) {
        alert('Primero debes escuchar el ejemplo.');
        return;
      }
      if (!gameData.stepsCompleted[2]) {
        alert('Primero debes grabar tu voz para completar la actividad.');
        return;
      }
      const currentLevel = parseInt(document.querySelector('#activity-title').textContent.match(/Nivel (\d+)/)?.[1] || gameData.maxUnlockedLevel);
      const rewards = gameData.levelRewards[currentLevel - 1];
      // Actualizar puntos, monedas y experiencia
      gameData.points += rewards.points;
      gameData.coins += rewards.coins;
      gameData.exp += rewards.exp;
      // Actualizar habilidades
      gameData.pronunciation += gameData.skillProgress[currentLevel - 1].pronunciation;
      gameData.vocabulary += gameData.skillProgress[currentLevel - 1].vocabulary;
      gameData.sentences += gameData.skillProgress[currentLevel - 1].sentences;
      // Limitar habilidades al 100%
      gameData.pronunciation = Math.min(gameData.pronunciation, 100);
      gameData.vocabulary = Math.min(gameData.vocabulary, 100);
      gameData.sentences = Math.min(gameData.sentences, 100);
      // Subir de nivel si es necesario
      if (gameData.exp >= gameData.expToNext) {
        gameData.currentLevel++;
        gameData.exp = 0;
        gameData.expToNext = Math.floor(gameData.expToNext * 1.5);
        gameData.points += 25; // Recompensa por subir de nivel
        alert(`¬°Felicidades! Has subido al nivel ${gameData.currentLevel}`);
      }
      // Desbloquear siguiente nivel
      if (currentLevel === gameData.maxUnlockedLevel) {
        gameData.maxUnlockedLevel = Math.min(gameData.maxUnlockedLevel + 1, 10);
      }
      updateScore();
      updateProgressBars();
      closeActivity();
      // Actualizar marcadores de nivel
      const markers = document.querySelectorAll('.path-marker');
      markers.forEach((marker, index) => {
        updateLevelMarker(marker, index + 1);
      });
      // Mover la canoa al siguiente nivel
      const canoe = document.getElementById('canoe');
      const nextMarker = document.querySelector(`.path-marker[data-level="${Math.min(currentLevel + 1, 10)}"]`);
      if (nextMarker) {
        canoe.style.transition = 'top 0.5s ease, left 0.5s ease';
        canoe.style.left = nextMarker.style.left;
        canoe.style.top = `calc(${nextMarker.style.top} + 30px)`;
      }
      alert(`¬°Nivel ${currentLevel} completado!
+${rewards.points} puntos
+${rewards.coins} monedas
+${rewards.exp} experiencia`);
    }
    // Canjear recompensa
    function redeemReward(cost) {
      if (gameData.coins >= cost) {
        gameData.coins -= cost;
        updateScore();
        alert('¬°Recompensa canjeada con √©xito! Pronto la recibir√°s.');
      } else {
        alert('No tienes suficientes monedas para canjear esta recompensa.');
      }
    }
    // Cambiar a un mundo espec√≠fico
    function changeWorld(worldId) {
      const worldModals = {
        1: 'world-1-modal',
        2: 'world-2-modal',
        3: 'world-3-modal',
        4: 'world-4-modal'
      };
      // Cerrar el modal de mundos
      document.getElementById('worlds-modal').style.display = 'none';
      // Mostrar el modal del mundo seleccionado
      document.getElementById(worldModals[worldId]).style.display = 'flex';
      // Actualizar el mundo actual
      gameData.currentWorld = worldId;
      // Actualizar la interfaz seg√∫n el mundo
      updateInterfaceForWorld(worldId);
    }
    // Actualizar interfaz seg√∫n el mundo
    function updateInterfaceForWorld(worldId) {
      const body = document.body;
      const header = document.getElementById('header');
      const footer = document.getElementById('footer');
      const riverCurves = document.querySelectorAll('.river-curve');
      const canoe = document.getElementById('canoe');
      // Aplicar estilos seg√∫n el mundo
      switch(worldId) {
        case 1: // Selva Profunda
          body.style.background = 'linear-gradient(to bottom, #2E7D32, #1B5E20)';
          riverCurves.forEach(curve => {
            curve.style.background = 'linear-gradient(90deg, transparent, #8BC34A, transparent)';
            curve.style.boxShadow = '0 0 15px rgba(139, 195, 74, 0.6), inset 0 0 20px rgba(139, 195, 74, 0.8)';
          });
          canoe.style.background = '#5D4037';
          break;
        case 2: // R√≠os y Cauces
          body.style.background = 'linear-gradient(to bottom, #0D47A1, #1565C0)';
          riverCurves.forEach(curve => {
            curve.style.background = 'linear-gradient(90deg, transparent, #42A5F5, transparent)';
            curve.style.boxShadow = '0 0 15px rgba(66, 165, 245, 0.6), inset 0 0 20px rgba(66, 165, 245, 0.8)';
          });
          canoe.style.background = '#8D6E63';
          break;
        case 3: // Claros del Bosque
          body.style.background = 'linear-gradient(to bottom, #F57F17, #FFA000)';
          riverCurves.forEach(curve => {
            curve.style.background = 'linear-gradient(90deg, transparent, #FFC107, transparent)';
            curve.style.boxShadow = '0 0 15px rgba(255, 193, 7, 0.6), inset 0 0 20px rgba(255, 193, 7, 0.8)';
          });
          canoe.style.background = '#5D4037';
          break;
        case 4: // Lluvias Tropicales
          body.style.background = 'linear-gradient(to bottom, #263238, #37474F)';
          riverCurves.forEach(curve => {
            curve.style.background = 'linear-gradient(90deg, transparent, #90A4AE, transparent)';
            curve.style.boxShadow = '0 0 15px rgba(144, 164, 174, 0.6), inset 0 0 20px rgba(144, 164, 174, 0.8)';
          });
          canoe.style.background = '#795548';
          break;
      }
      // Mostrar mensaje de bienvenida
      setTimeout(() => {
        const worldNames = ['Selva Profunda', 'R√≠os y Cauces', 'Claros del Bosque', 'Lluvias Tropicales'];
        alert(`¬°Bienvenido al mundo de la ${worldNames[worldId-1]}!`);
      }, 500);
    }
    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      createLeaves();
      updateScore();
      createRiverPath();
      updateProgressBars();
      // Bot√≥n de jugar - abre el primer nivel disponible
      document.getElementById('play-btn').addEventListener('click', function() {
        openActivity(gameData.maxUnlockedLevel);
      });
      // Bot√≥n de mundos
      document.getElementById('worlds-btn').addEventListener('click', function() {
        document.getElementById('worlds-modal').style.display = 'flex';
      });
      // Bot√≥n de recompensas
      document.getElementById('rewards-btn').addEventListener('click', function() {
        document.getElementById('rewards-modal').style.display = 'flex';
      });
      // Bot√≥n de progreso
      document.getElementById('progress-btn').addEventListener('click', function() {
        document.getElementById('progress-modal').style.display = 'flex';
      });
      // Cerrar modales con X
      document.querySelectorAll('.close').forEach(closeBtn => {
        closeBtn.addEventListener('click', function() {
          const modal = this.closest('.modal');
          if (modal.id !== 'worlds-modal') {
            modal.style.display = 'none';
          }
        });
      });
      // Cerrar modales con botones
      document.querySelector('.close-worlds').addEventListener('click', closeWorlds);
      document.querySelector('.close-rewards').addEventListener('click', closeRewards);
      document.querySelector('.close-progress').addEventListener('click', closeProgress);
      // Canjear recompensas
      document.querySelectorAll('#rewards-list button').forEach(btn => {
        btn.addEventListener('click', function() {
          redeemReward(parseInt(this.dataset.cost));
        });
      });
      // Seleccionar mundo
      document.querySelectorAll('.world-item').forEach(item => {
        item.addEventListener('click', function() {
          const world = parseInt(this.dataset.world);
          changeWorld(world);
        });
      });
      // Botones para entrar a mundos espec√≠ficos
      for (let i = 1; i <= 4; i++) {
        const btn = document.getElementById(`start-world-${i}`);
        if (btn) {
          btn.addEventListener('click', function() {
            document.getElementById(`world-${i}-modal`).style.display = 'none';
          });
        }
      }
      // Reproducir ejemplo
      document.getElementById('play-example').addEventListener('click', playExample);
      // Grabar voz
      document.getElementById('record-btn').addEventListener('click', recordVoice);
      // Completar actividad
      document.getElementById('complete-activity').addEventListener('click', completeActivity);
      // Cerrar modal al hacer clic fuera
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
          if (e.target === this && this.id !== 'worlds-modal') {
            this.style.display = 'none';
          }
        });
      });
    });
  </script>
</body>
</html>
